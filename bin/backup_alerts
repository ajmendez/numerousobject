#!/usr/bin/env python

import os
import json
os.path.append(os.path.expanduser('~/dev/numerousobject'))
import numerousobject.api



# OUTDIR = '/Volumes/video/backup_manything/alerts'
OUTDIR = os.path.expanduser('~/downloads/backup_manything/alerts')







def backup_alerts(outputdirectory):
    username, password = numerousobject.api.credentials()
    api = numerousobject.api.API(username, password)
    api.login()
    device = api.deviceinfo(1)
    
    # grab and save alerts
    print 'Downloading alerts...'
    alerts = api.getallalerts(device)
    json.dump(alerts, open(os.path.join(outputdirectory, 'info.json'), 'w'), indent=2)
    
    # Download images
    print 'Downloading images...'
    api.getalertstills(device, alerts, outputdirectory)
    print 'Done!'
    
    



if __name__ == '__main__':
    backup_alerts(OUTDIR)